\usepackage{csquotes}
\usepackage[style=numeric-comp,backref=true,isbn=false,doi=false,url=false]{biblatex}
\addbibresource{fca.bib}
\addbibresource{dl.bib}
\addbibresource{others.bib}
\addbibresource{arules.bib}
\addbibresource{order-theory.bib}
\addbibresource{linked-data.bib}

\usepackage{todonotes}

%%% packages

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{latexsym}
\usepackage{mathabx,stmaryrd}
\allowdisplaybreaks{}

\usepackage{verbatim}
\usepackage{graphicx}
\usepackage{enumerate}
\usepackage{array}
\usepackage{booktabs}
\usepackage{nicefrac}
\usepackage{listings}
\usepackage{microtype}
\usepackage{fixltx2e}
\usepackage{tabularx}
\usepackage{etoolbox}

\usepackage{tikz}
\usetikzlibrary{positioning,arrows,calc}
\tikzset{>=stealth'}

\usepackage{pgfplots}

\usepackage[hidelinks]{hyperref}
\usepackage[thmmarks,amsmath,hyperref]{ntheorem}
\usepackage{cleveref}
\let\thref\Cref\relax

\usepackage{scrpage2}

\renewcommand*{\pagemark}{%
  \usekomafont{pagenumber}%
  \ifodd\value{page}\makebox[\marginparwidth][l]{\pnumbar\enskip\thepage}%
  \else\makebox[\marginparwidth][r]{\thepage\enskip\pnumbar}%
  \fi
}%
\newcommand*{\pnumbar}{%
  \raisebox{0pt}[\ht\strutbox][\dp\strutbox]{%
    \rule[-\dp\strutbox]{1.5pt}{1.1\baselineskip}%
  }%
}
\AfterCalculatingTypearea{%
  \setheadwidth[0pt]{%
    \dimexpr\textwidth+\marginparsep+\marginparwidth\relax
  }%
}%
\recalctypearea

\makeatletter
\let\ps@plain\ps@empty
\makeatother

%%% fonts

\usepackage{mathpazo}
\usepackage[scale=0.95]{tgpagella}
\usepackage[scale=0.92]{tgheros}
\usepackage[scaled=0.83]{beramono}

\DeclareMathAlphabet{\mathbbm}{U}{bbm}{m}{n}

%%% formatting

\usepackage{titlesec}
\titleformat{\chapter}[display]
{\thispagestyle{empty}\bfseries\LARGE\raggedleft}
{\textcolor{black!66}{\Large \textsc{C\,h\,a\,p\,t\,e\,r}~~{\LARGE\thechapter}}}
{3ex}
{}

%%% general definitions

\newcommand{\ie}{i.\,e.\ }
\newcommand{\eg}{e.\,g.\ }
\newcommand{\etal}{et.\,al.\ }
\renewcommand{\dh}{d.\,h.\ }
\newcommand{\st}{\ensuremath{\colon}}
\newcommand{\holds}{\ensuremath{\colon}}

%%% 

\newcommand{\defnumbers}[1]{
  \expandafter\newcommand\expandafter{\csname #1#1\endcsname}{{\ensuremath{\mathbb{#1}}}}}
\defnumbers{N}
\defnumbers{Z}
\defnumbers{Q}
\defnumbers{R}
\defnumbers{C}
\defnumbers{P}
\defnumbers{K}
\defnumbers{L}

\newcommand{\ii}{{\ensuremath{\mathrm{i}}}}

\renewcommand{\phi}{\varphi}
\providecommand{\eps}{\varepsilon}
\newcommand{\set}[1]{{\ensuremath{\{\,#1\,\}}}}
\newcommand{\gen}[1]{\ensuremath{\left<\,#1\,\right>}}
\newcommand{\con}[1]{{\ensuremath{\mathbb{#1}}}}
\newcommand{\alg}[1]{{\ensuremath{\underline{#1}}}}
\newcommand{\rel}[1]{{\ensuremath{\mathrel{#1}}}}
\newcommand{\subsets}[1]{{\ensuremath{\mathfrak{P}(#1)}}}
\newcommand{\symdiff}{\ensuremath{\mathop\triangle}}
\newcommand{\diff}{\ensuremath{\;:\Longleftrightarrow\;}}
\newcommand{\abs}[1]{\ensuremath{\lvert#1\rvert}}

\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\bigO}{\mathcal{O}}
\DeclareMathOperator{\Bild}{Bild}
\DeclareMathOperator{\Can}{Can}
\DeclareMathOperator{\Char}{char}
\DeclareMathOperator{\Con}{Con}
\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\GF}{GF}
\DeclareMathOperator{\ggT}{ggT}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\grad}{grad}
\DeclareMathOperator{\Hom}{hom}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\Imp}{Imp}
\DeclareMathOperator{\Inn}{Inn}
\DeclareMathOperator{\Ker}{Ker}
\DeclareMathOperator{\Kern}{Kern}
\DeclareMathOperator{\kgV}{kgV}
\DeclareMathOperator{\ob}{ob}
\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\SL}{SL}

%%% formal concept analysis

\DeclareMathOperator{\BV}{{\mathfrak{B}}}
\DeclareMathOperator{\Cn}{Cn}
\DeclareMathOperator{\conf}{conf}
\DeclareMathOperator{\conImp}{conImp}
\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\Int}{Int}
\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\Th}{Th}

%%% description logics

\DeclareMathOperator{\mmsc}{mmsc}
\DeclareMathOperator{\lcs}{lcs}
\DeclareMathOperator{\pr}{pr}
\DeclareMathOperator{\Conf}{Conf}
\DeclareMathOperator{\Lux}{Lux}
\DeclareMathOperator{\names}{names}
\DeclareMathOperator{\rsucc}{succ}
\DeclareMathOperator{\lapprox}{approx}

\usepackage{xspace}

\providecommand{\EL}{{\ensuremath{\mathcal{E}\kern-.3ex\mathcal{L}}}\xspace}
\providecommand{\ELbot}{{\ensuremath{\EL^\bot}}\xspace}
\providecommand{\ELgfp}{{\ensuremath{\EL_\text{gfp}}}\xspace}
\providecommand{\ELgfpbot}{{\ensuremath{\EL_\text{gfp}^\bot}}\xspace}
\providecommand{\Idbpedia}{{\mathcal{I}_{\text{DBpedia}}}}
\providecommand{\ALC}{\ensuremath{\mathcal{A}\kern-0.05em\mathcal{L}\mathcal{C}}\xspace}
\providecommand{\FLE}{\ensuremath{\mathcal{F}\mathcal{L}\mathcal{E}}}

%%% programming

\lstdefinelanguage{PseudoCode}{
  alsoletter={-,?,/,*},
  basewidth=0.5em,
  classoffset=0,
  morekeywords={
    loop,with,recur,let,end,define,if,
    nil,then,else,return,for,while,do,
    read,and,where,input,output,procedure,
    forever,or,exit,forall,being,for,each,
    descending,assert,where,choose,
  },
  keywordstyle=\bfseries,
  classoffset=1,
  morekeywords={
    next-closed,model-gcis,empty?,make-ordered-set,
    add-elements,hasse-graph,seq,add-element,
    explore-attributes
  },
  keywordstyle=\upshape\ttfamily,
  classoffset=0,
  mathescape=true,
  texcl=true,
  commentstyle=\rm,
  numbers=left,
  stepnumber=1,
  firstnumber=0,
  numberstyle={\tiny},
  escapeinside={(*@}{@*)},
  morecomment=[l]{;},
  commentstyle={\itshape},
  columns=fullflexible,
}

\lstset{
  language=PseudoCode,
  frame=lines
}

\newcommand{\addfunctionname}[1]{%
  \lstset{classoffset=1,morekeywords={#1}}}

%%% theorem environments

\makeatletter

\newtheoremstyle{standard}%
{\item[\hskip\labelsep \theorem@headerfont ##2\ ##1\theorem@separator]}%
{\item[\hskip\labelsep \theorem@headerfont ##2\ ##1\ (##3)\theorem@separator]}
%
%
\theoremstyle{standard}
\theoremheaderfont{\normalfont\bfseries}
\theorembodyfont{\slshape}
\newtheorem{Theorem}     {Theorem} [section]
\newtheorem{Proposition} [Theorem] {Proposition}
\newtheorem{Lemma}       [Theorem] {Lemma}
\newtheorem{Corollary}   [Theorem] {Corollary}
%
\theoremheaderfont{\normalfont\bfseries}
\theorembodyfont{\normalfont}
\theoremsymbol{\ensuremath{\diamondsuit}}
%
\theoremheaderfont{\normalfont\bfseries}
\theorembodyfont{\normalfont}
\theoremsymbol{}
\newtheorem{Remark}      [Theorem] {Remark}
\theoremsymbol{\ensuremath{\diamondsuit}}
\newtheorem{Example}     [Theorem] {Example}
%
\theoremheaderfont{\normalfont\bfseries}
\theorembodyfont{\normalfont}
\theoremsymbol{\ensuremath{\diamondsuit}}
\newtheorem{Definition}  [Theorem] {Definition}
%
\theoremstyle{nonumberplain}
\theoremheaderfont{\normalfont\itshape}
\theorembodyfont{\normalfont\upshape}
\theoremsymbol{\ensuremath{\square}}
\newtheorem{Proof}                 {Proof}
%
\newtheoremstyle{standardreversed}%
{\item[\hskip\labelsep \theorem@headerfont ##1\ ##2\theorem@separator]}%
{\item[\hskip\labelsep \theorem@headerfont ##1\ ##2\ (##3)\theorem@separator]}
%
\theoremstyle{standardreversed}
\theoremheaderfont{\normalfont\bfseries}
\newtheorem{AlgorithmInternal}{Algorithm}
\newenvironment{Algorithm}
{\begin{AlgorithmInternal}}
{\end{AlgorithmInternal}}

% https://tex.stackexchange.com/questions/112404/
% reliable-code-for-automatic-noindent-after-specific-environments

\makeatletter
% uncomment the following if you don't want \clubpenalty\@M ...
% \let\nearly@afterheading\@afterheading
% \patchcmd\nearly@afterheading
%   {\@M}% original temporary setting for \clubpenalty replaced by ...
%   {\@clubpenalty}% ... or whichever value you deem right
%   {}{}
% ... and use \nearly@afterheading instead of \@afterheading here:
\newcommand*\NoIndentAfterEnv[1]{%
  \AfterEndEnvironment{#1}{\par\@afterindentfalse\@afterheading}}

\makeatother

\NoIndentAfterEnv{Definition}
\NoIndentAfterEnv{Lemma}
\NoIndentAfterEnv{Proof}
\NoIndentAfterEnv{Theorem}
\NoIndentAfterEnv{Corollary}
\NoIndentAfterEnv{Proposition}
\NoIndentAfterEnv{Remark}
\NoIndentAfterEnv{Example}
\NoIndentAfterEnv{equation*}
\NoIndentAfterEnv{align*}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "main"
%%% End: 
